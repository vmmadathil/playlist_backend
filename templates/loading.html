{% extends "layouts/base.html" %}

{% block title %} Freelancer Page {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

<main>
    <section class="section-header bg-secondary text-black" height = '100%'>
        <div class="container">
            <div class="row justify-content-between align-items-center">
                <div class="col-12 text-center text-md"></div>
                <div class="card shadow mb-6">
                    <div class="card-body px-5 py-5 text-center text-md-left">
                        <div class="row align-items-center">
                            <div id='body'>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='alert alert-danger'> Depending on your library, it might take a few minutes to make your playlist. Check back often.</div>
            </div>
        </div>
        </div>

    </section>

</main>


{% endblock content %}

<!-- Specific Page JS goes HERE  -->



{% block javascripts %}

<script src="https://unpkg.com/typewriter-effect@latest/dist/core.js"></script>

<script>
    var app = document.getElementById('body');

    var typewriter = new Typewriter(app, {
        loop: true,
        cursor: ''
    });

    typewriter.typeString('<h2>Connecting to Spotify</h2>')
        .pauseFor(3000)
        .deleteAll()
        .typeString('<h2>Looking at your library....</h2>')
        .pauseFor(3000)
        .deleteAll()
        .typeString('<h2>Your music taste is ...uh... interesting to say the least</h2>')
        .pauseFor(3000)
        .deleteAll()
        .typeString('<h2>Determining your favorite songs</h2>')
        .pauseFor(3000)
        .deleteAll()
        .typeString('<h2> ... nice... <h2>')
        .pauseFor(3000)
        .deleteAll()
        .typeString('<h2>Determining your favorite artists</h2>')
        .pauseFor(3000)
        .deleteAll()
        .typeString('<h2>lol... </h2>')
        .pauseFor(3000)
        .deleteAll()
        .typeString('<h2>Training the our song picking model</h2>')
        .pauseFor(3000)
        .deleteAll()
        .typeString('<h2>Finding some new songs for you</h2>')
        .pauseFor(3000)
        .deleteAll()
        .typeString("<h2>I know this is taking a while but you try sifting through Spotify's library</h2>")
        .pauseFor(3000)
        .deleteAll()
        .typeString("<h2>I'm just some code, don't get mad at me</h2>")
        .pauseFor(3000)
        .deleteAll()
        .start();
</script>

<script>
var request = new XMLHttpRequest();
request.open('POST', '/create');

request.onload = function() {
  if (request.status === 200 && request.responseText === 'done') {
    // long process finished successfully, redirect user
    window.location = '/success';
  } else {
    // ops, we got an error from the server
    alert('Something went wrong.');
  }
};

request.onerror = function() {
  // ops, we got an error trying to talk to the server
  alert('Something went wrong.');
};

request.send();

</script>

{% endblock javascripts %}